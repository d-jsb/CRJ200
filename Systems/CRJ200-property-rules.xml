<?xml version="1.0" encoding="UTF-8" ?>
<!--
	Property-rules run only at frame rate, while autopilot rules run at FDM rate.
	What is what depends on how the files are included in CRJ700-main.xml
-->
<PropertyList>
	<filter>
		<name>dhptr</name>
		<type>gain</type>
		<debug type="bool">false</debug>
		<gain>1</gain>
		<input>
			<expression>
				<dif>
				<property>instrumentation/adc/reference/dh</property>
				<property>instrumentation/radar-altimeter/radar-altitude-ft</property>
				</dif>
			</expression>
		</input>
		<output>instrumentation/radar-altimeter/dh-deviation</output>
	</filter>
	<filter>
		<name>mdaptr</name>
		<type>gain</type>
		<debug type="bool">false</debug>
		<gain>1</gain>
		<input>
			<expression>
				<dif>
				<property>instrumentation/altimeter/indicated-altitude-ft</property>
				<property>instrumentation/adc/reference/mda</property>
				</dif>
			</expression>
		</input>
		<output>instrumentation/altimeter/mda-deviation</output>
	</filter>	

	<filter>
		<name>alt-ref-deviation</name>
		<type>gain</type>
		<debug type="bool">false</debug>
		<gain>1</gain>
		<input>
			<expression>
				<abs><dif>
				<property>instrumentation/altimeter/setting-inhg</property>
				<property>environment/metar/pressure-inhg</property>
				</dif></abs>
			</expression>
		</input>
		<output>instrumentation/altimeter/ref-deviation</output>
	</filter>
	<filter>
		<name>VS scaler</name>
		<type>gain</type>
		<debug type="bool">false</debug>
		<gain>1</gain>
		<input>
			<property>instrumentation/vertical-speed-indicator/indicated-speed-fpm</property>
			<scale>0.001</scale>
		</input>
		<output>instrumentation/vertical-speed-indicator/indicated-speed-scaled</output>
	</filter>
	<filter>
		<name>SpeedTape</name>
		<type>gain</type>
		<debug type="bool">false</debug>
		<gain>1</gain>
		<input>
			<expression>
				<dif>
					<property>instrumentation/airspeed-indicator/indicated-speed-kt</property>
					<value>40</value>
				</dif>
			</expression>
		</input>
		<output>instrumentation/airspeed-indicator/ias-40</output>
	</filter>
	<filter>
		<name>V1marker</name>
		<type>gain</type>
		<debug type="bool">false</debug>
		<gain>1</gain>
		<input>
			<expression>
				<dif>
					<property>instrumentation/airspeed-indicator/indicated-speed-kt</property>
					<property>instrumentation/adc/reference/v1</property>
				</dif>
			</expression>
		</input>
		<output>instrumentation/adc/v1-diff</output>
	</filter>
	<filter>
		<name>VRmarker</name>
		<type>gain</type>
		<debug type="bool">false</debug>
		<gain>1</gain>
		<input>
			<expression>
				<dif>
					<property>instrumentation/airspeed-indicator/indicated-speed-kt</property>
					<property>instrumentation/adc/reference/vr</property>
				</dif>
			</expression>
		</input>
		<output>instrumentation/adc/vr-diff</output>
	</filter>	
	<filter>
		<name>V2marker</name>
		<type>gain</type>
		<debug type="bool">false</debug>
		<gain>1</gain>
		<input>
			<expression>
				<dif>
					<property>instrumentation/airspeed-indicator/indicated-speed-kt</property>
					<property>instrumentation/adc/reference/v2</property>
				</dif>
			</expression>
		</input>
		<output>instrumentation/adc/v2-diff</output>
	</filter>	
	<filter>
		<name>VTmarker</name>
		<type>gain</type>
		<debug type="bool">false</debug>
		<gain>1</gain>
		<input>
			<expression>
				<dif>
					<property>instrumentation/airspeed-indicator/indicated-speed-kt</property>
					<property>instrumentation/adc/reference/vt</property>
				</dif>
			</expression>
		</input>
		<output>instrumentation/adc/vt-diff</output>
	</filter>
	<logic>
		<name>On ground</name>
		<input>
			<or>
				<property>/gear/gear[0]/wow</property>
				<property>/gear/gear[1]/wow</property>
				<property>/gear/gear[2]/wow</property>
			</or>
		</input>
		<output>/gear/on-ground</output>
	</logic>	
	<!-- Alarm logic -->
	<logic>
		<name>Overspeed alarm</name>
		<input>
			<or>
				<!-- 3 kts greater than Vmo -->
				<greater-than-equals>
					<property>instrumentation/airspeed-indicator[0]/indicated-speed-kt</property>
					<value>338</value>
				</greater-than-equals>
				<!-- 0.01 Mach greater than Mmo -->
				<greater-than-equals>
					<property>instrumentation/airspeed-indicator[0]/indicated-mach</property>
					<value>0.86</value>
				</greater-than-equals>
			</or>
		</input>
		<output>sim/alarms/overspeed-alarm</output>
	</logic>
	<logic>
		<name>Master caution alarm</name>
		<input>
			<or>
				<property>instrumentation/mk-viii/outputs/discretes/gpws-alert</property>
				<property>instrumentation/mk-viii/outputs/discretes/gpws-warning</property>
				<property>sim/alarms/overspeed-alarm</property>
			</or>
		</input>
		<output>sim/alarms/master-caution</output>
	</logic>
	<logic>
		<name>Master warning alarm</name>
		<input>
			<or>
				<property>engines/apu/on-fire</property>
				<property>engines/engine[0]/on-fire</property>
				<property>engines/engine[1]/on-fire</property>
			</or>
		</input>
		<output>sim/alarms/master-warning</output>
	</logic>
	
	
	<filter>
		<name>flapsbar</name>
		<type>gain</type>
		<debug type="bool">false</debug>
		<gain>1</gain>
		<input>
			<expression>
				<table>
				<property>/surface-positions/flap-pos-norm</property> 
				<entry><ind>0</ind><dep>0</dep></entry>
				<entry><ind>0.177</ind><dep>1</dep></entry>
				<entry><ind>0.444</ind><dep>2</dep></entry>
				<entry><ind>0.666</ind><dep>3</dep></entry>
				<entry><ind>1</ind><dep>4</dep></entry>
				</table>
			</expression>
		</input>
		<output>instrumentation/EICAS/flaps-bar</output>
	</filter>
	
	
	<filter>
		<name>pfd_pitch</name>
		<type>gain</type>
		<debug type="bool">false</debug>
		<gain>1</gain>
		<input>
			<expression>
				<table>
				<property>/orientation/pitch-deg</property> 
				<entry><ind>-90</ind><dep>-1200</dep></entry>
				<entry><ind>-10</ind><dep>-80</dep></entry>
				<entry><ind>-5</ind><dep>-44</dep></entry>
				<entry><ind>0</ind><dep>0</dep></entry>
				<entry><ind>5</ind><dep>44</dep></entry>
				<entry><ind>10</ind><dep>80</dep></entry>
				<entry><ind>90</ind><dep>1200</dep></entry>
				</table>
			</expression>
		</input>
		<output>instrumentation/pfd[0]/pitch</output>
	</filter>
	
	
	<filter>
		<name>pfd_vsi_needle</name>
		<type>gain</type>
		<debug type="bool">false</debug>
		<gain>1</gain>
		<input>
			<expression>
				<table>
				<property>/instrumentation/vertical-speed-indicator/indicated-speed-fpm</property> 
				<entry><ind>3000</ind><dep>90</dep></entry>
				<entry><ind>2000</ind><dep>77</dep></entry>
				<entry><ind>1000</ind><dep>64.4</dep></entry>
				<entry><ind>0</ind><dep>0</dep></entry>
				<entry><ind>-1000</ind><dep>-64.4</dep></entry>
				<entry><ind>-2000</ind><dep>-77</dep></entry>
				<entry><ind>-3000</ind><dep>-90</dep></entry>
				</table>
			</expression>
		</input>
		<output>instrumentation/pfd[0]/vsi</output>
	</filter>
	
	<filter>
		<name>pfd_vmo</name>
		<type>gain</type>
		<debug type="bool">false</debug>
		<gain>1</gain>
		<input>
			<condition>
				<and>
					<equals>
						<property>/gear/gear[0]/position-norm</property>
						<value>0</value>
					</equals>
					<equals>
						<property>/gear/gear[1]/position-norm</property>
						<value>0</value>
					</equals>
					<equals>
						<property>/gear/gear[2]/position-norm</property>
						<value>0</value>
					</equals>
					<equals>
						<property>/surface-positions/flap-pos-norm</property>
						<value>0</value>
					</equals>
				</and>
			</condition>
			
			<expression>
				<table>
				<property>/instrumentation/altimeter/indicated-altitude-ft</property> 
				<entry><ind>0</ind><dep>330</dep></entry>
				<entry><ind>8000</ind><dep>330</dep></entry>
				<entry><ind>8001</ind><dep>335</dep></entry>
				<entry><ind>28300</ind><dep>315</dep></entry>
				</table>
			</expression>
		</input>
		<input>
			<condition>
				<and>
					<or>
						<not-equals>
							<property>/gear/gear[0]/position-norm</property>
							<value>0</value>
						</not-equals>
						<not-equals>
							<property>/gear/gear[1]/position-norm</property>
							<value>0</value>
						</not-equals>
						<not-equals>
							<property>/gear/gear[2]/position-norm</property>
							<value>0</value>
						</not-equals>
					</or>
					<or>
						<not-equals>
							<property>/gear/gear[0]/position-norm</property>
							<value>1</value>
						</not-equals>
						<not-equals>
							<property>/gear/gear[1]/position-norm</property>
							<value>1</value>
						</not-equals>
						<not-equals>
							<property>/gear/gear[2]/position-norm</property>
							<value>1</value>
						</not-equals>
					</or>
					<equals>
						<property>/controls/gear/gear-down</property>
						<value>0</value>
					</equals>
					<equals>
						<property>/surface-positions/flap-pos-norm</property>
						<value>0</value>
					</equals>
				</and>
			</condition>
			<value>200</value>
		</input>
		<input>
			<condition>
				<and>
					<or>
						<not-equals>
							<property>/gear/gear[0]/position-norm</property>
							<value>0</value>
						</not-equals>
						<not-equals>
							<property>/gear/gear[1]/position-norm</property>
							<value>0</value>
						</not-equals>
						<not-equals>
							<property>/gear/gear[2]/position-norm</property>
							<value>0</value>
						</not-equals>
					</or>
					<or>
						<not-equals>
							<property>/gear/gear[0]/position-norm</property>
							<value>1</value>
						</not-equals>
						<not-equals>
							<property>/gear/gear[1]/position-norm</property>
							<value>1</value>
						</not-equals>
						<not-equals>
							<property>/gear/gear[2]/position-norm</property>
							<value>1</value>
						</not-equals>
					</or>
					<equals>
						<property>/controls/gear/gear-down</property>
						<value>1</value>
					</equals>
					<equals>
						<property>/surface-positions/flap-pos-norm</property>
						<value>0</value>
					</equals>
				</and>
			</condition>
			<value>250</value>
		</input>
		<input>
			<condition>
				<and>
					<and>
						<equals>
							<property>/gear/gear[0]/position-norm</property>
							<value>1</value>
						</equals>
						<equals>
							<property>/gear/gear[1]/position-norm</property>
							<value>1</value>
						</equals>
						<equals>
							<property>/gear/gear[2]/position-norm</property>
							<value>1</value>
						</equals>
					</and>
					<equals>
						<property>/surface-positions/flap-pos-norm</property>
						<value>0</value>
					</equals>
				</and>
			</condition>
			<value>250</value>
		</input>
		<input>
			<condition>
				<and>
					<not>
						<and>
							<or>
								<not-equals>
									<property>/gear/gear[0]/position-norm</property>
									<value>0</value>
								</not-equals>
								<not-equals>
									<property>/gear/gear[1]/position-norm</property>
									<value>0</value>
								</not-equals>
								<not-equals>
									<property>/gear/gear[2]/position-norm</property>
									<value>0</value>
								</not-equals>
							</or>
							<or>
								<not-equals>
									<property>/gear/gear[0]/position-norm</property>
									<value>1</value>
								</not-equals>
								<not-equals>
									<property>/gear/gear[1]/position-norm</property>
									<value>1</value>
								</not-equals>
								<not-equals>
									<property>/gear/gear[2]/position-norm</property>
									<value>1</value>
								</not-equals>
							</or>
							<equals>
								<property>/controls/gear/gear-down</property>
								<value>0</value>
							</equals>
						</and>
					</not>
					<not-equals>
						<property>/surface-positions/flap-pos-norm</property>
						<value>0</value>
					</not-equals>
				</and>
			</condition>
			
			<expression>
				<table>
					<property>/surface-positions/flap-pos-norm</property>
					<entry><ind>0.177</ind><dep>230</dep></entry>
					<entry><ind>0.444</ind><dep>230</dep></entry>
					<entry><ind>0.666</ind><dep>196</dep></entry>
					<entry><ind>1</ind><dep>191</dep></entry>
				</table>
			</expression>
		</input>
		<output>instrumentation/pfd[0]/vmo</output>
	</filter>
	
	
	<predict-simple>
		<name>predicted IAS 10 seconds ahead</name>
		<debug>false</debug>
		<input>instrumentation/airspeed-indicator/indicated-speed-kt</input>
		<output>instrumentation/pfd/airspeed-10-sec-ahead</output>
		<seconds>10.0</seconds>
		<filter-gain>0.1</filter-gain>
	</predict-simple>
	<filter>
		<name>pfd_asi_predict_diff</name>
		<type>gain</type>
		<debug type="bool">false</debug>
		<gain>1</gain>
		<input>
			<expression>
				<difference>
					<property>instrumentation/pfd/airspeed-10-sec-ahead</property>
					<property>instrumentation/airspeed-indicator/indicated-speed-kt</property>
				</difference>
			</expression>
		</input>
		<output>instrumentation/pfd[0]/asi-predict-diff</output>
	</filter>
	<filter>
		<type>noise-spike</type>
		<max-rate-of-change>50</max-rate-of-change>
		<input>instrumentation/pfd[0]/asi-predict-diff</input>
		<output>instrumentation/pfd[0]/asi-predict-diff-damped</output>
	</filter>
	
	
	<filter>
		<name>ias_ref_diff</name>
		<type>gain</type>
		<debug type="bool">false</debug>
		<gain>1</gain>
		<input>
			<expression>
				<difference>
					<property>controls/autoflight/speed-select</property>
					<property>instrumentation/airspeed-indicator/indicated-speed-kt</property>
				</difference>
			</expression>
		</input>
		<output>instrumentation/pfd[0]/ias-ref-diff</output>
	</filter>
	
	
	<filter>
		<name>radar_alt_bar</name>
		<type>gain</type>
		<debug type="bool">false</debug>
		<gain>1</gain>
		<input>
			<expression>
				<table>
					<property>/position/gear-agl-ft</property>
					<entry><ind>0.0</ind><dep>0</dep></entry>
					<entry><ind>500</ind><dep>600</dep></entry>
					<entry><ind>1300</ind><dep>1080</dep></entry>
				</table>
			</expression>
		</input>
		<output>instrumentation/pfd[0]/radio-altitude-ft</output>
	</filter>
	
	
</PropertyList>
